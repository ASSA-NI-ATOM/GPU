# üßÆ Congruence-Only Prime Sieve (GPU + CPU)

[![CUDA](https://img.shields.io/badge/CUDA-11.0+-green.svg)](https://developer.nvidia.com/cuda-toolkit)
[![C++](https://img.shields.io/badge/C%2B%2B-11-blue.svg)](https://en.cppreference.com/w/cpp/11)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Performance](https://img.shields.io/badge/Performance-60%20Gbit%2Fs-brightgreen)](FINAL_PROJECT_SUMMARY.md)

**–£–ª—å—Ç—Ä–∞-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–æ—Å—Ç—ã—Ö —á–∏—Å–µ–ª –≤ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞—Ö [(N-2)¬≤, N¬≤]**

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **üî• –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: ~60 –ì–±–∏—Ç/—Å –Ω–∞ RTX 4070
- **‚ö° GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ**: 35-40x –±—ã—Å—Ç—Ä–µ–µ CPU –≤–µ—Ä—Å–∏–∏  
- **üßÆ Congruence-Only –ø–æ–¥—Ö–æ–¥**: –±–µ–∑ —Ä–µ—à–µ—Ç–∞ –≠—Ä–∞—Ç–æ—Å—Ñ–µ–Ω–∞
- **üíæ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏**: bit-packed –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
- **‚úÖ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π**: –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

## üö® **–í–ê–ñ–ù–û: –í–µ—Ä—Å–∏—è 2.0 —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏**

**–í –≤–µ—Ä—Å–∏–∏ 1.x –±—ã–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞**, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–≤–æ–¥–∏–ª–∞ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º. **–í–µ—Ä—Å–∏—è 2.0 —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.**

### –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- ‚ùå **–ë—ã–ª–æ**: `x ‚â° N¬≤ (mod p)` (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω–≥—Ä—É—ç–Ω—Ü–∏—è)
- ‚úÖ **–°—Ç–∞–ª–æ**: `x ‚â° 0 (mod p)` (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω–≥—Ä—É—ç–Ω—Ü–∏—è)
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: —á–∏—Å–ª–æ 25 —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ —Å–æ—Å—Ç–∞–≤–Ω–æ–µ –ø—Ä–∏ N=6

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| N | –ò–Ω—Ç–µ—Ä–≤–∞–ª | GPU –≤—Ä–µ–º—è | CPU –≤—Ä–µ–º—è | Speedup | Throughput |
|---|----------|-----------|-----------|---------|------------|
| 6 | [16, 36] | 0.001s | 0.000s | 1x | 4.0 Mbit/s |
| 999 | [994K, 998K] | 0.001s | 0.000s | 1x | 133.1 Mbit/s |
| 9,999,999 | [99.9T, 99.9T] | 0.660s | 0.883s | 1.3x | 45.3 Mbit/s |
| **999,999,999** | [999T, 999T] | **67.4s** | ~2400s | **36x** | **59.4 Mbit/s** |

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **CUDA Toolkit** 11.0+
- **GPU**: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Compute Capability 6.0+
- **GCC** –¥–ª—è CPU –≤–µ—Ä—Å–∏–∏

### –ö–æ–º–ø–∏–ª—è—Ü–∏—è

```bash
# GPU –≤–µ—Ä—Å–∏—è (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è RTX 4070)
nvcc -O3 -arch=sm_86 -o gpu_sieve congruence_sieve_gpu.cu

# CPU –≤–µ—Ä—Å–∏—è
gcc -O3 -o cpu_sieve congruence_sieve_cpu.c -lm
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –¥–ª—è N=999,999,999 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ç–µ—Å—Ç)
./gpu_sieve 999999999

# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ (N=6)
./gpu_sieve 6
# –û–∂–∏–¥–∞–µ—Ç—Å—è: "GPU prime count: 5" (—á–∏—Å–ª–∞: 17, 19, 23, 29, 31)

# CPU —Ä–µ—Ñ–µ—Ä–µ–Ω—Å
./cpu_sieve 6
```

## üìà –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
Congruence-Only Sieve GPU Implementation (ULTRA-OPTIMIZED)
=========================================================
N = 999999999
Interval: [(999999997)¬≤, (999999999)¬≤] = [999999994000000009, 999999998000000001]
Interval size: 3999999992 numbers (3999999992 bits)
Bit-packed memory: 500000000 bytes

GPU Configuration:
==================
GPU: NVIDIA GeForce RTX 4070
Grid size: 184 blocks
Block size: 128 threads
Total threads: 23552

Results:
========
GPU prime count: 96508729
Time: 67.375 s
Throughput: 59.4 Mbit/s (5.4x vs CPU)

‚úì GPU computation completed successfully!
```

## üßÆ –ê–ª–≥–æ—Ä–∏—Ç–º

–ú–µ—Ç–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ **–∫–æ–Ω–≥—Ä—É—ç–Ω—Ü–∏—è—Ö**: —á–∏—Å–ª–æ x —Å–æ—Å—Ç–∞–≤–Ω–æ–µ ‚ü∫ ‚àÉp ‚â§ N: x ‚â° 0 (mod p)

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- **–ë–µ–∑ sieve**: –Ω–µ –Ω—É–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å —Ä–µ—à–µ—Ç–æ –≠—Ä–∞—Ç–æ—Å—Ñ–µ–Ω–∞
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å**: –∫–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —á–∏—Å–ª–∞
- **Memory efficiency**: bit-packed –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (8x —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏)

### –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **Pre-computed prime list**: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ CPU –æ–¥–∏–Ω —Ä–∞–∑
- **Compact prime storage**: —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ —á–∏—Å–ª–∞ ‚â§ N
- **Bit manipulation**: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∏—Ç–∞–º–∏
- **Block-level optimization**: –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è memory access patterns

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/
‚îú‚îÄ‚îÄ congruence_sieve_gpu.cu          # üî• –û—Å–Ω–æ–≤–Ω–∞—è GPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ congruence_sieve_cpu.c           # üìä CPU —Ä–µ—Ñ–µ—Ä–µ–Ω—Å –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏  
‚îú‚îÄ‚îÄ COMPILATION_AND_TESTING.md      # üõ† –ö–æ–º–∞–Ω–¥—ã –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ FINAL_PROJECT_SUMMARY.md        # üìã –ü–æ–ª–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç
‚îú‚îÄ‚îÄ examples/                       # üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ docs/                          # üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ tests/                         # üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
```bash
./gpu_sieve 6
# –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏: "GPU prime count: 5"
# –ü—Ä–æ—Å—Ç—ã–µ —á–∏—Å–ª–∞ –≤ [16,36]: 17, 19, 23, 29, 31
```

### Benchmark —Ç–µ—Å—Ç—ã
```bash
# –ú–∞–ª—ã–µ N (–±—ã—Å—Ç—Ä–æ)
./gpu_sieve 999

# –°—Ä–µ–¥–Ω–∏–µ N (—Å–µ–∫—É–Ω–¥—ã)  
./gpu_sieve 9999999

# –ë–æ–ª—å—à–∏–µ N (–º–∏–Ω—É—Ç—ã, —Ä–µ–∞–ª—å–Ω—ã–π benchmark)
./gpu_sieve 999999999
```

## üîß –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö GPU

```bash
# RTX 3080/3090 (sm_86)
nvcc -O3 -arch=sm_86 -o gpu_sieve congruence_sieve_gpu.cu

# RTX 2080 (sm_75)
nvcc -O3 -arch=sm_75 -o gpu_sieve congruence_sieve_gpu.cu

# GTX 1080 (sm_61)
nvcc -O3 -arch=sm_61 -o gpu_sieve congruence_sieve_gpu.cu

# –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
nvidia-smi --query-gpu=compute_cap --format=csv
```

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π N**: ~2¬≥¬π (overflow protection)
- **Memory requirements**: ~(4N-4)/8 bytes –¥–ª—è bit array
- **GPU memory**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ —Ä–∞–∑–º–µ—Ä–æ–º VRAM (~500MB –¥–ª—è N=10‚Åπ)

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. **Fork** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ **feature branch** (`git checkout -b feature/amazing-optimization`)
3. **Commit** –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -am 'Add amazing optimization'`)
4. **Push** –≤ branch (`git push origin feature/amazing-optimization`)
5. –°–æ–∑–¥–∞–π—Ç–µ **Pull Request**

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∞–π–ª [LICENSE](LICENSE)

## üë• –ê–≤—Ç–æ—Ä—ã

- **Siarhei Tabalevich** - –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ GPU –∏ CPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **Siargei. Aleksandrov** - –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã

- [CUDA Samples](https://github.com/NVIDIA/cuda-samples) - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã CUDA
- [Prime Algorithms]([[https://primes.utm.edu/lists/small/gaps.html](https://en.wikipedia.org/wiki/Generation_of_primes)](https://t5k.org/)) - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö —á–∏—Å–µ–ª

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Issues**: [GitHub Issues](https://github.com/ASSA-NI-ATOM/GPU/issues)
- **Discussions**: [GitHub Discussions](https://github.com/ASSA-NI-ATOM/GPU/discussions)

---

‚≠ê **–ü–æ–Ω—Ä–∞–≤–∏–ª—Å—è –ø—Ä–æ–µ–∫—Ç? –ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!** ‚≠ê
